(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4531],{617:function(e,t,r){Promise.resolve().then(r.bind(r,8328))},9763:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var a=r(2265),s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),i=(e,t)=>{let r=(0,a.forwardRef)((r,i)=>{let{color:o="currentColor",size:c=24,strokeWidth:l=2,absoluteStrokeWidth:u,className:d="",children:m,...h}=r;return(0,a.createElement)("svg",{ref:i,...s,width:c,height:c,stroke:o,strokeWidth:u?24*Number(l)/Number(c):l,className:["lucide","lucide-".concat(n(e)),d].join(" "),...h},[...t.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(m)?m:[m]])});return r.displayName="".concat(e),r}},6221:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},1769:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]])},1047:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},8997:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},9637:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]])},5863:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},7692:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},8293:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]])},3417:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},3229:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},3247:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},8728:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},8896:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},7806:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]])},2369:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},5805:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},2489:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},9376:function(e,t,r){"use strict";var a=r(5475);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},8328:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return j}});var a=r(7437),s=r(2265),n=r(3002),i=r(8742),o=r(9376),c=r(3249),l=r(2315),u=r(2850),d=r(1769),m=r(5805),h=r(3247),y=r(9763);let p=(0,y.Z)("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]),g=(0,y.Z)("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);var x=r(7806),f=r(3229);function b(){var e,t;let{user:r}=(0,c.a)(),n=(0,o.useRouter)(),[i,y]=(0,s.useState)(!0),[b,j]=(0,s.useState)(!1),[v,w]=(0,s.useState)(null),[k,N]=(0,s.useState)([]),[S,T]=(0,s.useState)([]),[_,M]=(0,s.useState)([]),[E,q]=(0,s.useState)(""),[C,Z]=(0,s.useState)(new Set),[O,A]=(0,s.useState)(""),[J,P]=(0,s.useState)(""),[R,z]=(0,s.useState)(!0),[D,I]=(0,s.useState)(""),[H,L]=(0,s.useState)(!1);(0,s.useEffect)(()=>{U()},[]);let U=async()=>{try{y(!0),w(null);let[e,t]=await Promise.all([l.u.getJourneyTemplates({isPublic:!0,limit:100,sortBy:"name",sortOrder:"asc"}),u.H.getMembers({limit:1e3,sortBy:"firstName",sortOrder:"asc"})]);N(e.templates),T(t.members);let r=t.members.filter(e=>["admin","pastor","group_leader"].includes(e.role||""));M(r)}catch(e){w(e instanceof Error?e.message:"Failed to load data")}finally{y(!1)}},W=e=>{Z(t=>{let r=new Set(t);return r.has(e)?r.delete(e):r.add(e),r})},B=()=>D.trim()?S.filter(e=>{let t="".concat(e.firstName," ").concat(e.lastName).toLowerCase(),r=e.email.toLowerCase(),a=D.toLowerCase();return t.includes(a)||r.includes(a)}):S,V=async e=>{if(e.preventDefault(),!E){w("Please select a journey template");return}if(0===C.size){w("Please select at least one member");return}j(!0),w(null);try{let e=Array.from(C);if(1===e.length){let t={memberId:e[0],journeyTemplateId:E,mentorId:O||void 0,notes:J.trim()||void 0,startImmediately:R};await l.u.assignJourneyToMember(t)}else await l.u.bulkAssignJourney(e,E,O||void 0);n.push("/journeys")}catch(e){w(e instanceof Error?e.message:"Failed to assign journey")}finally{j(!1)}},G=null==k?void 0:k.find(e=>e.id===E),F=B();return i?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):(0,a.jsxs)("form",{onSubmit:V,className:"space-y-8",children:[v&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,a.jsx)("div",{className:"text-sm text-red-700",children:v})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-neutral-200 p-6",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-neutral-900 mb-4 flex items-center",children:[(0,a.jsx)(d.Z,{className:"w-5 h-5 mr-2"}),"Select Journey Template"]}),(0,a.jsx)("div",{className:"space-y-3",children:k.map(e=>(0,a.jsxs)("label",{className:"flex items-start p-4 border-2 rounded-lg cursor-pointer transition-colors ".concat(E===e.id?"border-primary-500 bg-primary-50":"border-neutral-200 hover:border-neutral-300"),children:[(0,a.jsx)("input",{type:"radio",name:"template",value:e.id,checked:E===e.id,onChange:e=>q(e.target.value),className:"mt-1 text-primary-600 focus:ring-primary-500"}),(0,a.jsxs)("div",{className:"ml-3 flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-neutral-900",children:e.name}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ".concat("beginner"===e.difficulty?"bg-green-100 text-green-800":"intermediate"===e.difficulty?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:e.difficulty}),(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[e.milestones.length," milestones"]}),(0,a.jsxs)("span",{className:"text-xs text-neutral-500",children:[Math.ceil(e.estimatedDuration/7)," weeks"]})]})]}),(0,a.jsx)("p",{className:"text-sm text-neutral-600 mb-2",children:e.description}),e.tags&&e.tags.length>0&&(0,a.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.tags.slice(0,3).map(e=>(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-neutral-100 text-neutral-700",children:e},e)),e.tags.length>3&&(0,a.jsxs)("span",{className:"text-xs text-neutral-500",children:["+",e.tags.length-3," more"]})]})]})]},e.id))}),0===k.length&&(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(d.Z,{className:"w-12 h-12 text-neutral-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-neutral-600",children:"No journey templates available"})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-neutral-200 p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-neutral-900 flex items-center",children:[(0,a.jsx)(m.Z,{className:"w-5 h-5 mr-2"}),"Select Members (",C.size," selected)"]}),(0,a.jsxs)("button",{type:"button",onClick:()=>L(!H),className:"inline-flex items-center px-3 py-2 border border-neutral-300 rounded-md text-sm font-medium text-neutral-700 bg-white hover:bg-neutral-50",children:[(0,a.jsx)(h.Z,{className:"w-4 h-4 mr-2"}),H?"Hide Search":"Search Members"]})]}),H&&(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(h.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-neutral-400 w-4 h-4"}),(0,a.jsx)("input",{type:"text",placeholder:"Search members by name or email...",className:"w-full pl-10 pr-4 py-2 border border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:D,onChange:e=>I(e.target.value)})]})}),(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsxs)("button",{type:"button",onClick:()=>{let e=B();e.every(e=>C.has(e.id))?Z(t=>{let r=new Set(t);return e.forEach(e=>r.delete(e.id)),r}):Z(t=>{let r=new Set(t);return e.forEach(e=>r.add(e.id)),r})},className:"inline-flex items-center text-sm text-primary-600 hover:text-primary-700",children:[F.every(e=>C.has(e.id))?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p,{className:"w-4 h-4 mr-1"}),"Deselect All"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g,{className:"w-4 h-4 mr-1"}),"Select All"]}),D&&" (".concat(F.length," filtered)")]})}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 max-h-64 overflow-y-auto",children:F.map(e=>(0,a.jsxs)("label",{className:"flex items-center p-3 border rounded-lg cursor-pointer transition-colors ".concat(C.has(e.id)?"border-primary-500 bg-primary-50":"border-neutral-200 hover:border-neutral-300"),children:[(0,a.jsx)("input",{type:"checkbox",checked:C.has(e.id),onChange:()=>W(e.id),className:"rounded border-neutral-300 text-primary-600 focus:ring-primary-500"}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-neutral-900",children:[e.firstName," ",e.lastName]}),(0,a.jsx)("div",{className:"text-xs text-neutral-500",children:e.email}),e.role&&(0,a.jsx)("div",{className:"text-xs text-neutral-400 capitalize",children:e.role.replace("_"," ")})]})]},e.id))}),0===F.length&&(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(m.Z,{className:"w-12 h-12 text-neutral-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-neutral-600",children:D?"No members found matching your search":"No members available"})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-neutral-200 p-6",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-neutral-900 mb-4 flex items-center",children:[(0,a.jsx)(x.Z,{className:"w-5 h-5 mr-2"}),"Assignment Options"]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Assign Mentor (Optional)"}),(0,a.jsxs)("select",{className:"w-full px-3 py-2 border border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:O,onChange:e=>A(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"No mentor assigned"}),_.map(e=>{var t;return(0,a.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName," (",null===(t=e.role)||void 0===t?void 0:t.replace("_"," "),")"]},e.id)})]}),(0,a.jsx)("p",{className:"mt-1 text-xs text-neutral-500",children:"Mentors can guide members through their journey and approve milestone completions"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Notes (Optional)"}),(0,a.jsx)("textarea",{rows:3,className:"w-full px-3 py-2 border border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:J,onChange:e=>P(e.target.value),placeholder:"Add any notes or instructions for this assignment..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,a.jsx)("input",{type:"checkbox",className:"rounded border-neutral-300 text-primary-600 focus:ring-primary-500",checked:R,onChange:e=>z(e.target.checked)}),(0,a.jsx)("span",{className:"text-sm font-medium text-neutral-700",children:"Start journey immediately"})]}),(0,a.jsx)("p",{className:"mt-1 ml-6 text-xs text-neutral-500",children:"If unchecked, members will need to manually start their journey"})]})]})]}),E&&C.size>0&&(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"Assignment Summary"}),(0,a.jsxs)("div",{className:"text-sm text-blue-800",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:null==G?void 0:G.name})," will be assigned to"," ",(0,a.jsx)("strong",{children:C.size})," member",1!==C.size?"s":""]}),(0,a.jsxs)("p",{children:["Estimated duration: ",(0,a.jsxs)("strong",{children:[G?Math.ceil(G.estimatedDuration/7):0," weeks"]})]}),O&&(0,a.jsxs)("p",{children:["Mentor: ",(0,a.jsxs)("strong",{children:[null===(e=_.find(e=>e.id===O))||void 0===e?void 0:e.firstName," ",null===(t=_.find(e=>e.id===O))||void 0===t?void 0:t.lastName]})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{n.back()},className:"px-4 py-2 border border-neutral-300 rounded-md text-sm font-medium text-neutral-700 bg-white hover:bg-neutral-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Cancel"}),(0,a.jsxs)("button",{type:"submit",disabled:b||!E||0===C.size,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50",children:[b?(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):(0,a.jsx)(f.Z,{className:"w-4 h-4 mr-2"}),"Assign Journey",C.size>1?"s":""]})]})]})}function j(){return(0,a.jsx)(n.Z,{requiredRole:"group_leader",children:(0,a.jsx)(i.Z,{children:(0,a.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-neutral-900",children:"Assign Journey"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-neutral-600",children:"Assign spiritual growth journeys to members and track their progress"})]}),(0,a.jsx)(b,{})]})})})}},2315:function(e,t,r){"use strict";r.d(t,{u:function(){return o}});let a="https://faithlink360-api.onrender.com",s=new Map,n=new Map;class i{async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3e4,i="".concat(a).concat(e),o=localStorage.getItem("auth_token"),c={"Content-Type":"application/json",...o&&{Authorization:"Bearer ".concat(o)}},l={...t,headers:{...c,...t.headers}};if(r&&"GET"===t.method){let e=s.get(r);if(e&&Date.now()-e.timestamp<e.ttl)return console.log("Cache hit for ".concat(r)),e.data}let u=Error("Request failed");for(let e=1;e<=3;e++)try{let a=await fetch(i,l);if(!a.ok){if(429===a.status){await new Promise(t=>setTimeout(t,1e3*e));continue}throw Error("HTTP ".concat(a.status,": ").concat(a.statusText))}let o=await a.json();return r&&"GET"===t.method&&s.set(r,{data:o,timestamp:Date.now(),ttl:n}),o}catch(t){if(u=t instanceof Error?t:Error("Unknown error"),3===e)break;await new Promise(t=>setTimeout(t,1e3*e))}throw u}async getJourneyTemplates(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;Object.entries(e).forEach(e=>{let[r,a]=e;null!=a&&""!==a&&(Array.isArray(a)?a.forEach(e=>t.append(r,String(e))):t.append(r,String(a)))});let r="journey_templates_".concat(t.toString());return this.request("/api/journey-templates?".concat(t.toString()),{method:"GET"},r)}async getJourneyTemplate(e){return this.request("/api/journey-templates/".concat(e),{method:"GET"},"journey_template_".concat(e))}async createJourneyTemplate(e){let t=await this.request("/api/journey-templates",{method:"POST",body:JSON.stringify(e)});return this.invalidateTemplateCache(),t}async updateJourneyTemplate(e){let t=await this.request("/api/journey-templates/".concat(e.id),{method:"PUT",body:JSON.stringify(e)});return s.delete("journey_template_".concat(e.id)),this.invalidateTemplateCache(),t}async deleteJourneyTemplate(e){await this.request("/api/journey-templates/".concat(e),{method:"DELETE"}),s.delete("journey_template_".concat(e)),this.invalidateTemplateCache()}async duplicateJourneyTemplate(e,t){let r=await this.request("/api/journey-templates/".concat(e,"/duplicate"),{method:"POST",body:JSON.stringify({name:t})});return this.invalidateTemplateCache(),r}async getMemberJourneys(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;Object.entries(e).forEach(e=>{let[r,a]=e;null!=a&&""!==a&&t.append(r,String(a))});let r="member_journeys_".concat(t.toString());return this.request("/journeys/member-journeys?".concat(t.toString()),{method:"GET"},r)}async getMemberJourney(e){return this.request("/journeys/member-journeys/".concat(e),{method:"GET"},"member_journey_".concat(e))}async assignJourneyToMember(e){let t=await this.request("/journeys/member-journeys",{method:"POST",body:JSON.stringify(e)});return this.invalidateMemberJourneyCache(),t}async updateMemberJourney(e){let t=await this.request("/journeys/member-journeys/".concat(e.id),{method:"PUT",body:JSON.stringify(e)});return s.delete("member_journey_".concat(e.id)),this.invalidateMemberJourneyCache(),t}async deleteMemberJourney(e){await this.request("/journeys/member-journeys/".concat(e),{method:"DELETE"}),s.delete("member_journey_".concat(e)),this.invalidateMemberJourneyCache()}async getMilestoneProgress(e,t){let r="milestone_progress_".concat(e,"_").concat(t);return this.request("/journeys/member-journeys/".concat(e,"/milestones/").concat(t,"/progress"),{method:"GET"},r)}async startMilestone(e,t){let r=await this.request("/journeys/member-journeys/".concat(e,"/milestones/").concat(t,"/start"),{method:"POST"});return s.delete("member_journey_".concat(e)),s.delete("milestone_progress_".concat(e,"_").concat(t)),r}async completeMilestone(e,t,r){let a=await this.request("/journeys/member-journeys/".concat(e,"/milestones/").concat(t,"/complete"),{method:"POST",body:JSON.stringify({notes:r})});return s.delete("member_journey_".concat(e)),s.delete("milestone_progress_".concat(e,"_").concat(t)),a}async submitMilestone(e){let t=new FormData;t.append("type",e.type),t.append("content",e.content),e.attachments&&e.attachments.forEach((e,r)=>{t.append("attachment_".concat(r),e)});let r=localStorage.getItem("auth_token"),s=await fetch("".concat(a,"/api/journeys/milestone-progress/").concat(e.milestoneProgressId,"/submit"),{method:"POST",headers:{...r&&{Authorization:"Bearer ".concat(r)}},body:t});if(!s.ok)throw Error("HTTP ".concat(s.status,": ").concat(s.statusText));let n=await s.json();return this.invalidateMemberJourneyCache(),n}async approveMilestone(e,t,r){let a=await this.request("/journeys/member-journeys/".concat(e,"/milestones/").concat(t,"/approve"),{method:"POST",body:JSON.stringify({feedback:r})});return s.delete("member_journey_".concat(e)),s.delete("milestone_progress_".concat(e,"_").concat(t)),a}async requestMilestoneRevision(e,t,r){let a=await this.request("/journeys/member-journeys/".concat(e,"/milestones/").concat(t,"/request-revision"),{method:"POST",body:JSON.stringify({feedback:r})});return s.delete("member_journey_".concat(e)),s.delete("milestone_progress_".concat(e,"_").concat(t)),a}async getJourneyStats(){return this.request("/journeys/stats",{method:"GET"},"journey_stats",6e4)}async getMemberJourneyStats(e){return this.request("/journeys/members/".concat(e,"/stats"),{method:"GET"},"member_journey_stats_".concat(e),6e4)}async bulkAssignJourney(e,t,r){let a=await this.request("/journeys/bulk-assign",{method:"POST",body:JSON.stringify({memberIds:e,templateId:t,mentorId:r})});return this.invalidateMemberJourneyCache(),a}async bulkUpdateJourneyStatus(e,t){await this.request("/journeys/bulk-status",{method:"POST",body:JSON.stringify({journeyIds:e,status:t})}),this.invalidateMemberJourneyCache()}async exportJourneyTemplate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"json",r=await fetch("".concat(a,"/api/journey-templates/").concat(e,"/export?format=").concat(t),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("auth_token"))}});if(!r.ok)throw Error("Export failed: ".concat(r.statusText));return r.blob()}async exportMemberJourneyProgress(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pdf",r=await fetch("".concat(a,"/journeys/member-journeys/").concat(e,"/export?format=").concat(t),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("auth_token"))}});if(!r.ok)throw Error("Export failed: ".concat(r.statusText));return r.blob()}invalidateTemplateCache(){for(let[e]of s)e.includes("journey_template")&&s.delete(e)}invalidateMemberJourneyCache(){for(let[e]of s)(e.includes("member_journey")||e.includes("milestone_progress"))&&s.delete(e)}clearCache(){s.clear(),n.clear()}}let o=new i},2850:function(e,t,r){"use strict";r.d(t,{H:function(){return n}});let a="https://faithlink360-api.onrender.com";class s{async fetchWithAuth(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=localStorage.getItem("auth_token"),a=e.startsWith("http")?e:"http://localhost:8000".concat(e),s=0;for(;s<=this.MAX_RETRIES;)try{let e=await fetch(a,{...t,headers:{"Content-Type":"application/json",...r&&{Authorization:"Bearer ".concat(r)},...t.headers}});if(!e.ok){if(401===e.status){localStorage.removeItem("auth_token"),window.location.href="/login";return}let t=await e.json().catch(()=>({message:e.statusText}));throw Error(t.message||"HTTP ".concat(e.status,": ").concat(e.statusText))}return e.json()}catch(e){if(s<this.MAX_RETRIES&&e.message.includes("fetch")){s++,await new Promise(e=>setTimeout(e,1e3*s));continue}throw e}}getCacheKey(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(e,"-").concat(JSON.stringify(t.body||{}))}isValidCache(e){let t=this.requestCache.get(e);return!!t&&Date.now()-t.timestamp<this.CACHE_DURATION}async getMembers(e){let t=new URLSearchParams;if(e){var r,a,s;e.query&&t.append("query",e.query),(null===(r=e.tags)||void 0===r?void 0:r.length)&&t.append("tags",e.tags.join(",")),(null===(a=e.membershipStatus)||void 0===a?void 0:a.length)&&t.append("status",e.membershipStatus.join(",")),e.sortBy&&t.append("sortBy",e.sortBy),e.sortOrder&&t.append("sortOrder",e.sortOrder),e.limit&&t.append("limit",e.limit.toString()),e.offset&&t.append("offset",e.offset.toString()),e.ageRange&&(e.ageRange.min&&t.append("ageMin",e.ageRange.min.toString()),e.ageRange.max&&t.append("ageMax",e.ageRange.max.toString())),e.joinDateRange&&(e.joinDateRange.start&&t.append("joinStart",e.joinDateRange.start.toISOString()),e.joinDateRange.end&&t.append("joinEnd",e.joinDateRange.end.toISOString())),(null===(s=e.groups)||void 0===s?void 0:s.length)&&t.append("groups",e.groups.join(","))}let n="/api/members".concat(t.toString()?"?".concat(t.toString()):""),i=this.getCacheKey(n);if(this.isValidCache(i))return this.requestCache.get(i).data;if(this.pendingRequests.has(i))return this.pendingRequests.get(i);let o=this.fetchWithAuth(n).then(e=>(this.requestCache.set(i,{data:e,timestamp:Date.now()}),this.pendingRequests.delete(i),e)).catch(e=>{throw this.pendingRequests.delete(i),e});return this.pendingRequests.set(i,o),o}async getMember(e){return this.fetchWithAuth("/api/members/".concat(e))}async createMember(e){return this.fetchWithAuth("/api/members",{method:"POST",body:JSON.stringify(e)})}async updateMember(e){return this.fetchWithAuth("/api/members/".concat(e.id),{method:"PUT",body:JSON.stringify(e)})}async deleteMember(e){await this.fetchWithAuth("/api/members/".concat(e),{method:"DELETE"})}async getMemberStats(){return this.fetchWithAuth("/api/members/stats")}async getTags(){return this.fetchWithAuth("/api/members/tags")}async createTag(e){return this.fetchWithAuth("/api/members/tags",{method:"POST",body:JSON.stringify(e)})}async updateTag(e,t){return this.fetchWithAuth("/api/members/tags/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async deleteTag(e){await this.fetchWithAuth("/api/members/tags/".concat(e),{method:"DELETE"})}async uploadProfilePhoto(e,t){let r=localStorage.getItem("auth_token"),s=new FormData;s.append("photo",t);let n=await fetch("".concat(a,"/api/members/").concat(e,"/photo"),{method:"POST",headers:{...r&&{Authorization:"Bearer ".concat(r)}},body:s});if(!n.ok)throw Error((await n.json().catch(()=>({message:n.statusText}))).message||"HTTP ".concat(n.status,": ").concat(n.statusText));return n.json()}async getSearchSuggestions(e){return this.fetchWithAuth("/api/members/search/suggestions?q=".concat(encodeURIComponent(e)))}async exportMembers(e){let t=new URLSearchParams;if(e){var r,s;e.query&&t.append("query",e.query),(null===(r=e.tags)||void 0===r?void 0:r.length)&&t.append("tags",e.tags.join(",")),(null===(s=e.membershipStatus)||void 0===s?void 0:s.length)&&t.append("status",e.membershipStatus.join(","))}let n=localStorage.getItem("auth_token"),i=await fetch("".concat(a,"/api/members/export").concat(t.toString()?"?".concat(t.toString()):""),{headers:{...n&&{Authorization:"Bearer ".concat(n)}}});if(!i.ok)throw Error("Export failed: ".concat(i.statusText));return i.blob()}async bulkUpdateMembers(e,t){return this.fetchWithAuth("/api/members/bulk",{method:"PUT",body:JSON.stringify({memberIds:e,updates:t})})}async bulkDeleteMembers(e){return this.fetchWithAuth("/api/members/bulk",{method:"DELETE",body:JSON.stringify({memberIds:e})})}constructor(){this.requestCache=new Map,this.pendingRequests=new Map,this.CACHE_DURATION=3e4,this.MAX_RETRIES=2}}let n=new s}},function(e){e.O(0,[7648,4429,2971,2117,1744],function(){return e(e.s=617)}),_N_E=e.O()}]);
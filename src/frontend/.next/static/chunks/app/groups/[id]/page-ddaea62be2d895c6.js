(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9953],{8037:function(e,t,s){Promise.resolve().then(s.bind(s,6458))},6458:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return F}});var a=s(7437),r=s(2265),n=s(9376),i=s(3002),l=s(8742),o=s(7648),c=s(3249),d=s(3430),m=s(2850),u=s(5805),h=s(8617),p=s(1723),x=s(3774),g=s(4630),b=s(1047),f=s(3417),y=s(6221),j=s(8728),N=s(8736),v=s(2718),w=s(7806),S=s(8906),k=s(8837),T=s(3113),A=s(9658),E=s(9397),C=s(2252),M=s(2489),R=s(7689),O=s(2735),I=s(8930);function P(e){let{groupId:t}=e,[s,n]=(0,r.useState)([]),[i,l]=(0,r.useState)(!0),[o,c]=(0,r.useState)(!1),[d,m]=(0,r.useState)(!1),[u,h]=(0,r.useState)(null),[p,x]=(0,r.useState)(null),[g,b]=(0,r.useState)({fileName:"",fileSize:0,fileType:"",description:""});(0,r.useEffect)(()=>{f()},[t]);let f=async()=>{try{l(!0);let e=await fetch("http://localhost:8000/api/groups/".concat(t,"/files"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("auth_token"))}});if(e.ok){let t=await e.json();n(t.files||[])}else h("Failed to load files")}catch(e){h("Network error loading files"),console.error("Error fetching files:",e)}finally{l(!1)}},y=async e=>{if(e.preventDefault(),!g.fileName.trim()){h("File name is required");return}c(!0),h(null);try{let e=await fetch("http://localhost:8000/api/groups/".concat(t,"/files"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("auth_token"))},body:JSON.stringify(g)});if(e.ok){let t=await e.json();n(e=>[t.file,...e]),x("File uploaded successfully!"),m(!1),b({fileName:"",fileSize:0,fileType:"",description:""}),setTimeout(()=>x(null),3e3)}else{let t=await e.json();h(t.error||"Failed to upload file")}}catch(e){h("Network error uploading file"),console.error("Error uploading file:",e)}finally{c(!1)}},j=async e=>{if(confirm("Are you sure you want to delete this file?"))try{(await fetch("http://localhost:8000/api/groups/".concat(t,"/files/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(localStorage.getItem("auth_token"))}})).ok?(n(t=>t.filter(t=>t.id!==e)),x("File deleted successfully!"),setTimeout(()=>x(null),3e3)):h("Failed to delete file")}catch(e){h("Network error deleting file"),console.error("Error deleting file:",e)}},v=async e=>{try{window.open("http://localhost:8000".concat(e.url),"_blank")}catch(e){h("Failed to download file"),console.error("Error downloading file:",e)}},w=e=>{if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]},S=e=>e.startsWith("image/")?(0,a.jsx)(T.Z,{className:"w-5 h-5 text-blue-500"}):e.includes("pdf")?(0,a.jsx)(N.Z,{className:"w-5 h-5 text-red-500"}):(0,a.jsx)(A.Z,{className:"w-5 h-5 text-gray-500"});return i?(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),(0,a.jsx)("p",{className:"text-center text-gray-500 mt-2",children:"Loading files..."})]}):(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Group Files"}),(0,a.jsxs)("button",{onClick:()=>m(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors",children:[(0,a.jsx)(E.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Upload File"})]})]}),p&&(0,a.jsx)("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:(0,a.jsx)("p",{className:"text-green-800 text-sm",children:p})}),u&&(0,a.jsxs)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-start",children:[(0,a.jsx)(C.Z,{className:"w-5 h-5 text-red-600 mr-2 mt-0.5"}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("p",{className:"text-red-800 text-sm",children:u})}),(0,a.jsx)("button",{onClick:()=>h(null),className:"text-red-400 hover:text-red-600",children:(0,a.jsx)(M.Z,{className:"w-4 h-4"})})]}),d&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold",children:"Upload File"}),(0,a.jsx)("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(M.Z,{className:"w-5 h-5"})})]}),(0,a.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"File Name *"}),(0,a.jsx)("input",{type:"text",value:g.fileName,onChange:e=>b(t=>({...t,fileName:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Meeting Notes.pdf",required:!0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"File Size (bytes)"}),(0,a.jsx)("input",{type:"number",value:g.fileSize,onChange:e=>b(t=>({...t,fileSize:parseInt(e.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"File Type"}),(0,a.jsxs)("select",{value:g.fileType,onChange:e=>b(t=>({...t,fileType:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"",children:"Select type"}),(0,a.jsx)("option",{value:"application/pdf",children:"PDF"}),(0,a.jsx)("option",{value:"image/jpeg",children:"JPEG Image"}),(0,a.jsx)("option",{value:"image/png",children:"PNG Image"}),(0,a.jsx)("option",{value:"application/msword",children:"Word Document"}),(0,a.jsx)("option",{value:"text/plain",children:"Text File"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,a.jsx)("textarea",{value:g.description,onChange:e=>b(t=>({...t,description:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Optional description..."})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("button",{type:"submit",disabled:o,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Uploading..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(R.Z,{className:"w-4 h-4 mr-2"}),"Upload"]})}),(0,a.jsx)("button",{type:"button",onClick:()=>m(!1),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"})]})]})]})}),0===s.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(A.Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500 text-lg mb-2",children:"No files uploaded yet"}),(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:"Upload files to share with your group members"})]}):(0,a.jsx)("div",{className:"space-y-3",children:s.map(e=>(0,a.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-sm transition-shadow",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 flex-1",children:[S(e.type),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-gray-500 mt-1",children:[(0,a.jsx)("span",{children:w(e.size)}),(0,a.jsxs)("span",{children:["Uploaded by ",e.uploadedByName]}),(0,a.jsx)("span",{children:new Date(e.uploadDate).toLocaleDateString()})]}),e.description&&(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:e.description})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>v(e),className:"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-lg transition-colors",title:"Download file",children:(0,a.jsx)(O.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>j(e.id),className:"p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-lg transition-colors",title:"Delete file",children:(0,a.jsx)(I.Z,{className:"w-4 h-4"})})]})]})},e.id))})]})}var Z=s(4743),D=s(1810),W=s(8997),_=s(8893);function G(e){let{groupId:t}=e,[s,n]=(0,r.useState)([]),[i,l]=(0,r.useState)(!0),[o,c]=(0,r.useState)(!1),[d,m]=(0,r.useState)(null),[u,h]=(0,r.useState)(""),[p,x]=(0,r.useState)(null),[g,b]=(0,r.useState)(""),f=(0,r.useRef)(null);(0,r.useEffect)(()=>{j()},[t]),(0,r.useEffect)(()=>{y()},[s]);let y=()=>{var e;null===(e=f.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},j=async()=>{try{l(!0);let e=await fetch("http://localhost:8000/api/groups/".concat(t,"/messages"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("auth_token"))}});if(e.ok){let t=await e.json();n(t.messages||[])}else m("Failed to load messages")}catch(e){m("Network error loading messages"),console.error("Error fetching messages:",e)}finally{l(!1)}},N=async e=>{if(e.preventDefault(),u.trim()){c(!0),m(null);try{let e=await fetch("http://localhost:8000/api/groups/".concat(t,"/messages"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("auth_token"))},body:JSON.stringify({content:u.trim(),mentions:[],attachments:[]})});if(e.ok){let t=await e.json();n(e=>[...e,t.data]),h("")}else{let t=await e.json();m(t.error||"Failed to send message")}}catch(e){m("Network error sending message"),console.error("Error sending message:",e)}finally{c(!1)}}},v=async e=>{if(g.trim())try{let s=await fetch("http://localhost:8000/api/groups/".concat(t,"/messages/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("auth_token"))},body:JSON.stringify({content:g.trim()})});if(s.ok){let t=await s.json();n(s=>s.map(s=>s.id===e?{...s,content:t.content,edited:!0,editedAt:t.editedAt}:s)),x(null),b("")}else m("Failed to edit message")}catch(e){m("Network error editing message"),console.error("Error editing message:",e)}},w=async e=>{if(confirm("Are you sure you want to delete this message?"))try{(await fetch("http://localhost:8000/api/groups/".concat(t,"/messages/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(localStorage.getItem("auth_token"))}})).ok?n(t=>t.filter(t=>t.id!==e)):m("Failed to delete message")}catch(e){m("Network error deleting message"),console.error("Error deleting message:",e)}},S=async(e,s)=>{try{(await fetch("http://localhost:8000/api/groups/".concat(t,"/messages/").concat(e,"/reactions"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("auth_token"))},body:JSON.stringify({type:s})})).ok?console.log("Reaction added successfully"):m("Failed to add reaction")}catch(e){m("Network error adding reaction"),console.error("Error adding reaction:",e)}},k=e=>{let t=new Date(e),s=(new Date().getTime()-t.getTime())/36e5;return s<1?"".concat(Math.floor(60*s),"m ago"):s<24?"".concat(Math.floor(s),"h ago"):t.toLocaleDateString()};return i?(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),(0,a.jsx)("p",{className:"text-center text-gray-500 mt-2",children:"Loading messages..."})]}):(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-gray-200 bg-white",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Group Messages"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Share updates and stay connected with your group"})]}),d&&(0,a.jsxs)("div",{className:"mx-4 mt-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-start",children:[(0,a.jsx)(C.Z,{className:"w-5 h-5 text-red-600 mr-2 mt-0.5"}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("p",{className:"text-red-800 text-sm",children:d})}),(0,a.jsx)("button",{onClick:()=>m(null),className:"text-red-400 hover:text-red-600",children:(0,a.jsx)(M.Z,{className:"w-4 h-4"})})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[0===s.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(Z.Z,{className:"w-6 h-6 text-gray-400"})}),(0,a.jsx)("p",{className:"text-gray-500 text-lg mb-2",children:"No messages yet"}),(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:"Start a conversation with your group!"})]}):s.map(e=>(0,a.jsx)("div",{className:"group",children:(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-sm font-medium",children:e.authorName.charAt(0)})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.authorName}),(0,a.jsx)("span",{className:"text-xs text-gray-500 capitalize",children:e.authorRole}),(0,a.jsx)("span",{className:"text-xs text-gray-400",children:k(e.timestamp)}),e.edited&&(0,a.jsx)("span",{className:"text-xs text-gray-400",children:"(edited)"})]}),p===e.id?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("textarea",{value:g,onChange:e=>b(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,autoFocus:!0}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>v(e.id),className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",children:"Save"}),(0,a.jsx)("button",{onClick:()=>{x(null),b("")},className:"px-3 py-1 bg-gray-300 text-gray-700 text-sm rounded hover:bg-gray-400",children:"Cancel"})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{className:"text-gray-800 text-sm",children:e.content}),e.reactions.length>0&&(0,a.jsx)("div",{className:"flex items-center space-x-2 mt-2",children:e.reactions.map((t,s)=>(0,a.jsxs)("button",{onClick:()=>S(e.id,t.type),className:"flex items-center space-x-1 px-2 py-1 bg-gray-100 hover:bg-gray-200 rounded-full text-xs",children:["like"===t.type?(0,a.jsx)(D.Z,{className:"w-3 h-3"}):(0,a.jsx)(W.Z,{className:"w-3 h-3"}),(0,a.jsx)("span",{children:t.count})]},s))})]})]}),(0,a.jsx)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity",children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("button",{onClick:()=>S(e.id,"like"),className:"p-1 text-gray-400 hover:text-blue-500 rounded",title:"Like",children:(0,a.jsx)(D.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>S(e.id,"heart"),className:"p-1 text-gray-400 hover:text-red-500 rounded",title:"Heart",children:(0,a.jsx)(W.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>{x(e.id),b(e.content)},className:"p-1 text-gray-400 hover:text-yellow-500 rounded",title:"Edit",children:(0,a.jsx)(_.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>w(e.id),className:"p-1 text-gray-400 hover:text-red-500 rounded",title:"Delete",children:(0,a.jsx)(I.Z,{className:"w-4 h-4"})})]})})]})},e.id)),(0,a.jsx)("div",{ref:f})]}),(0,a.jsx)("div",{className:"p-4 border-t border-gray-200 bg-white",children:(0,a.jsxs)("form",{onSubmit:N,className:"flex space-x-3",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("textarea",{value:u,onChange:e=>h(e.target.value),placeholder:"Type your message...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",rows:2,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),N(e))}})}),(0,a.jsx)("button",{type:"submit",disabled:o||!u.trim(),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2 transition-colors",children:o?(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):(0,a.jsx)(Z.Z,{className:"w-4 h-4"})})]})})]})}function q(e){var t,s,i;let{groupId:l}=e,{user:T}=(0,c.a)();(0,n.useRouter)();let[A,E]=(0,r.useState)(null),[C,M]=(0,r.useState)([]),[R,O]=(0,r.useState)([]),[I,Z]=(0,r.useState)(!0),[D,W]=(0,r.useState)(null),[_,q]=(0,r.useState)(!1),[F,B]=(0,r.useState)(""),[U,z]=(0,r.useState)("members");(0,r.useEffect)(()=>{L()},[l]);let L=async()=>{try{Z(!0),W(null);let[e,t]=await Promise.all([d.P.getGroup(l),d.P.getGroupMembers(l)]);E(e),M(t);let s=await m.H.getMembers({limit:1e3}),a=t.map(e=>e.memberId),r=s.members.filter(e=>!a.includes(e.id));O(r)}catch(e){W(e instanceof Error?e.message:"Failed to load group")}finally{Z(!1)}},J=async()=>{if(F)try{await d.P.addGroupMember(l,F),B(""),q(!1),await L()}catch(e){W(e instanceof Error?e.message:"Failed to add member")}},H=async e=>{if(confirm("Are you sure you want to remove this member from the group?"))try{await d.P.removeGroupMember(l,e),await L()}catch(e){W(e instanceof Error?e.message:"Failed to remove member")}},K=async(e,t)=>{try{await d.P.updateGroupMember(l,e,{role:t}),await L()}catch(e){W(e instanceof Error?e.message:"Failed to update member role")}},X=(null==T?void 0:T.role)==="admin"||(null==T?void 0:T.role)==="pastor"||A&&(A.leaderId===(null==T?void 0:T.id)||(null===(t=A.coLeaderIds)||void 0===t?void 0:t.includes((null==T?void 0:T.id)||"")));return I?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):D||!A?(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,a.jsx)("div",{className:"text-sm text-red-700",children:D||"Group not found"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-neutral-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-neutral-900",children:A.name}),(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("small_group"===A.type?"bg-blue-100 text-blue-800":"ministry"===A.type?"bg-green-100 text-green-800":"youth"===A.type?"bg-purple-100 text-purple-800":"bg-neutral-100 text-neutral-800"),children:{small_group:"Small Group",ministry:"Ministry",youth:"Youth",seniors:"Seniors",womens:"Women's",mens:"Men's",children:"Children's",worship:"Worship",service:"Service",bible_study:"Bible Study",prayer:"Prayer",outreach:"Outreach",other:"Other"}[i=A.type]||i}),(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("active"===A.status?"bg-green-100 text-green-800":"inactive"===A.status?"bg-yellow-100 text-yellow-800":"bg-neutral-100 text-neutral-800"),children:A.status})]}),A.description&&(0,a.jsx)("p",{className:"text-neutral-600 mb-4",children:A.description}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center text-neutral-600",children:[(0,a.jsx)(u.Z,{className:"w-4 h-4 mr-2"}),(null===(s=A.memberIds)||void 0===s?void 0:s.length)||A.currentMembers||0," members",A.maxMembers&&" / ".concat(A.maxMembers," max")]}),(0,a.jsxs)("div",{className:"flex items-center text-neutral-600",children:[(0,a.jsx)(h.Z,{className:"w-4 h-4 mr-2"}),"Leader: ",A.leaderName]}),A.meetingSchedule&&(0,a.jsxs)("div",{className:"flex items-center text-neutral-600",children:[(0,a.jsx)(p.Z,{className:"w-4 h-4 mr-2"}),(e=>{if(!e||!e.frequency)return"No schedule set";let t=void 0!==e.dayOfWeek?["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e.dayOfWeek]:"",s=e.time||"",a=e.duration?"(".concat(e.duration," min)"):"";return"".concat(e.frequency," on ").concat(t," at ").concat(s," ").concat(a).trim()})(A.meetingSchedule)]}),A.location&&(0,a.jsxs)("div",{className:"flex items-center text-neutral-600",children:[(0,a.jsx)(x.Z,{className:"w-4 h-4 mr-2"}),A.location]})]})]}),X&&(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)(o.default,{href:"/groups/".concat(A.id,"/edit"),className:"inline-flex items-center px-3 py-2 border border-neutral-300 rounded-md text-sm font-medium text-neutral-700 bg-white hover:bg-neutral-50",children:[(0,a.jsx)(g.Z,{className:"w-4 h-4 mr-2"}),"Edit"]}),(0,a.jsxs)(o.default,{href:"/groups/".concat(A.id,"/attendance"),className:"inline-flex items-center px-3 py-2 border border-transparent rounded-md text-sm font-medium text-white bg-primary-600 hover:bg-primary-700",children:[(0,a.jsx)(b.Z,{className:"w-4 h-4 mr-2"}),"Attendance"]})]})]})}),A.tags&&A.tags.length>0&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-neutral-200 p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-neutral-900 mb-3",children:"Tags"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:A.tags.map(e=>(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 text-primary-800",children:e},e))})]}),X&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-neutral-200 p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-neutral-900 mb-4",children:"Quick Actions"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,a.jsxs)(o.default,{href:"/groups/".concat(A.id,"/attendance/new"),className:"flex flex-col items-center p-4 rounded-lg border-2 border-dashed border-neutral-200 hover:border-primary-300 hover:bg-primary-50 transition-colors",children:[(0,a.jsx)(b.Z,{className:"w-8 h-8 text-primary-600 mb-2"}),(0,a.jsx)("span",{className:"text-sm font-medium text-neutral-900",children:"Record Attendance"})]}),(0,a.jsxs)(o.default,{href:"/communications/group/".concat(A.id),className:"flex flex-col items-center p-4 rounded-lg border-2 border-dashed border-neutral-200 hover:border-primary-300 hover:bg-primary-50 transition-colors",children:[(0,a.jsx)(f.Z,{className:"w-8 h-8 text-primary-600 mb-2"}),(0,a.jsx)("span",{className:"text-sm font-medium text-neutral-900",children:"Message Group"})]}),(0,a.jsxs)(o.default,{href:"/groups/".concat(A.id,"/reports"),className:"flex flex-col items-center p-4 rounded-lg border-2 border-dashed border-neutral-200 hover:border-primary-300 hover:bg-primary-50 transition-colors",children:[(0,a.jsx)(y.Z,{className:"w-8 h-8 text-primary-600 mb-2"}),(0,a.jsx)("span",{className:"text-sm font-medium text-neutral-900",children:"View Reports"})]}),(0,a.jsxs)(o.default,{href:"/groups/".concat(A.id,"/settings"),className:"flex flex-col items-center p-4 rounded-lg border-2 border-dashed border-neutral-200 hover:border-primary-300 hover:bg-primary-50 transition-colors",children:[(0,a.jsx)(j.Z,{className:"w-8 h-8 text-primary-600 mb-2"}),(0,a.jsx)("span",{className:"text-sm font-medium text-neutral-900",children:"Group Settings"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-neutral-200",children:[(0,a.jsx)("div",{className:"border-b border-neutral-200",children:(0,a.jsxs)("nav",{className:"flex space-x-8 px-6","aria-label":"Tabs",children:[(0,a.jsxs)("button",{onClick:()=>z("members"),className:"py-4 px-1 border-b-2 font-medium text-sm ".concat("members"===U?"border-primary-500 text-primary-600":"border-transparent text-neutral-500 hover:text-neutral-700 hover:border-neutral-300"),children:[(0,a.jsx)(u.Z,{className:"w-4 h-4 inline mr-2"}),"Members (",C.length,")"]}),(0,a.jsxs)("button",{onClick:()=>z("files"),className:"py-4 px-1 border-b-2 font-medium text-sm ".concat("files"===U?"border-primary-500 text-primary-600":"border-transparent text-neutral-500 hover:text-neutral-700 hover:border-neutral-300"),children:[(0,a.jsx)(N.Z,{className:"w-4 h-4 inline mr-2"}),"Files"]}),(0,a.jsxs)("button",{onClick:()=>z("messages"),className:"py-4 px-1 border-b-2 font-medium text-sm ".concat("messages"===U?"border-primary-500 text-primary-600":"border-transparent text-neutral-500 hover:text-neutral-700 hover:border-neutral-300"),children:[(0,a.jsx)(v.Z,{className:"w-4 h-4 inline mr-2"}),"Messages"]})]})}),"members"===U&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"p-6 border-b border-neutral-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-neutral-900",children:["Members (",C.length,")"]}),X&&(0,a.jsxs)("button",{onClick:()=>q(!0),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700",children:[(0,a.jsx)(w.Z,{className:"w-4 h-4 mr-2"}),"Add Member"]})]})}),_&&(0,a.jsx)("div",{className:"p-6 border-b border-neutral-200 bg-neutral-50",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)("select",{className:"flex-1 px-3 py-2 border border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:F,onChange:e=>B(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Select a member to add"}),R.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id))]}),(0,a.jsx)("button",{onClick:J,disabled:!F,className:"px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 disabled:opacity-50",children:"Add"}),(0,a.jsx)("button",{onClick:()=>{q(!1),B("")},className:"px-4 py-2 border border-neutral-300 text-sm font-medium rounded-md text-neutral-700 bg-white hover:bg-neutral-50",children:"Cancel"})]})}),(0,a.jsx)("div",{className:"p-6",children:0===C.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(u.Z,{className:"w-12 h-12 text-neutral-400 mx-auto mb-4"}),(0,a.jsx)("h4",{className:"text-lg font-medium text-neutral-900 mb-2",children:"No members yet"}),(0,a.jsx)("p",{className:"text-neutral-600 mb-4",children:"Add members to get started with your group"}),X&&(0,a.jsxs)("button",{onClick:()=>q(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700",children:[(0,a.jsx)(w.Z,{className:"w-4 h-4 mr-2"}),"Add First Member"]})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:C.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border border-neutral-200 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(u.Z,{className:"w-5 h-5 text-primary-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-900",children:e.memberName}),"leader"===e.role&&(0,a.jsx)(h.Z,{className:"w-4 h-4 text-yellow-500"}),"co_leader"===e.role&&(0,a.jsx)(S.Z,{className:"w-4 h-4 text-blue-500"})]}),(0,a.jsx)("p",{className:"text-xs text-neutral-500 capitalize",children:e.role.replace("_"," ")})]})]}),X&&"leader"!==e.role&&(0,a.jsxs)("div",{className:"flex space-x-1",children:["member"===e.role&&(0,a.jsx)("button",{onClick:()=>K(e.memberId,"co_leader"),className:"text-xs px-2 py-1 text-blue-600 hover:bg-blue-50 rounded",title:"Promote to Co-Leader",children:(0,a.jsx)(S.Z,{className:"w-3 h-3"})}),"co_leader"===e.role&&(0,a.jsx)("button",{onClick:()=>K(e.memberId,"member"),className:"text-xs px-2 py-1 text-neutral-600 hover:bg-neutral-50 rounded",title:"Demote to Member",children:(0,a.jsx)(u.Z,{className:"w-3 h-3"})}),(0,a.jsx)("button",{onClick:()=>H(e.memberId),className:"text-xs px-2 py-1 text-red-600 hover:bg-red-50 rounded",title:"Remove from Group",children:(0,a.jsx)(k.Z,{className:"w-3 h-3"})})]})]},e.id))})})]}),"files"===U&&(0,a.jsx)(P,{groupId:l}),"messages"===U&&(0,a.jsx)("div",{className:"h-96",children:(0,a.jsx)(G,{groupId:l})})]})]})}function F(){let e=(0,n.useParams)().id;return(0,a.jsx)(i.Z,{children:(0,a.jsx)(l.Z,{children:(0,a.jsx)(q,{groupId:e})})})}},3430:function(e,t,s){"use strict";s.d(t,{P:function(){return n}});let a="https://faithlink360-api.onrender.com";class r{async fetchWithAuth(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=localStorage.getItem("auth_token"),r={"Content-Type":"application/json",...s&&{Authorization:"Bearer ".concat(s)},...t.headers},n=0;for(;n<=this.MAX_RETRIES;)try{let s=await fetch("".concat(a).concat(e),{...t,headers:r});if(!s.ok){if(429===s.status&&n<this.MAX_RETRIES){await new Promise(e=>setTimeout(e,1e3*(n+1))),n++;continue}let e=await s.json().catch(()=>({message:s.statusText}));throw Error(e.message||"HTTP ".concat(s.status,": ").concat(s.statusText))}return s.json()}catch(e){if(n<this.MAX_RETRIES&&e.message.includes("fetch")){n++,await new Promise(e=>setTimeout(e,1e3*n));continue}throw e}}getCacheKey(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(e,"-").concat(JSON.stringify(t.body||{}))}isValidCache(e){let t=this.requestCache.get(e);return!!t&&Date.now()-t.timestamp<this.CACHE_DURATION}async getGroups(e){let t=new URLSearchParams;if(e){var s,a,r;e.query&&t.append("query",e.query),(null===(s=e.type)||void 0===s?void 0:s.length)&&t.append("type",e.type.join(",")),(null===(a=e.status)||void 0===a?void 0:a.length)&&t.append("status",e.status.join(",")),e.leaderId&&t.append("leaderId",e.leaderId),(null===(r=e.tags)||void 0===r?void 0:r.length)&&t.append("tags",e.tags.join(",")),void 0!==e.hasAvailableSpace&&t.append("hasAvailableSpace",e.hasAvailableSpace.toString()),e.sortBy&&t.append("sortBy",e.sortBy),e.sortOrder&&t.append("sortOrder",e.sortOrder),e.limit&&t.append("limit",e.limit.toString()),e.offset&&t.append("offset",e.offset.toString())}let n="/api/groups".concat(t.toString()?"?".concat(t.toString()):""),i=this.getCacheKey(n);if(this.isValidCache(i))return this.requestCache.get(i).data;if(this.pendingRequests.has(i))return this.pendingRequests.get(i);let l=this.fetchWithAuth(n).then(e=>(this.requestCache.set(i,{data:e,timestamp:Date.now()}),this.pendingRequests.delete(i),e)).catch(e=>{throw this.pendingRequests.delete(i),e});return this.pendingRequests.set(i,l),l}async getGroup(e){return this.fetchWithAuth("/api/groups/".concat(e))}async createGroup(e){return this.fetchWithAuth("/api/groups",{method:"POST",body:JSON.stringify(e)})}async updateGroup(e){return this.fetchWithAuth("/api/groups/".concat(e.id),{method:"PUT",body:JSON.stringify(e)})}async deleteGroup(e){await this.fetchWithAuth("/api/groups/".concat(e),{method:"DELETE"})}async getGroupMembers(e){return(await this.fetchWithAuth("/api/groups/".concat(e,"/members"))).members||[]}async addGroupMember(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"member";return this.fetchWithAuth("/api/groups/".concat(e,"/members"),{method:"POST",body:JSON.stringify({memberId:t,role:s})})}async updateGroupMember(e,t,s){return this.fetchWithAuth("/api/groups/".concat(e,"/members/").concat(t),{method:"PUT",body:JSON.stringify(s)})}async removeGroupMember(e,t){await this.fetchWithAuth("/api/groups/".concat(e,"/members/").concat(t),{method:"DELETE"})}async getGroupAttendance(e,t,s){let a=new URLSearchParams;t&&a.append("startDate",t),s&&a.append("endDate",s);let r="/api/groups/".concat(e,"/attendance").concat(a.toString()?"?".concat(a.toString()):"");return this.fetchWithAuth(r)}async recordAttendance(e){return this.fetchWithAuth("/api/groups/".concat(e.groupId,"/attendance"),{method:"POST",body:JSON.stringify(e)})}async updateAttendance(e,t,s){return this.fetchWithAuth("/api/groups/".concat(e,"/attendance/").concat(t),{method:"PUT",body:JSON.stringify(s)})}async deleteAttendance(e,t){await this.fetchWithAuth("/api/groups/".concat(e,"/attendance/").concat(t),{method:"DELETE"})}async getGroupStats(){return this.fetchWithAuth("/api/groups/stats")}async getGroupAttendanceStats(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"month";return this.fetchWithAuth("/api/groups/".concat(e,"/stats/attendance?period=").concat(t))}async exportGroups(e){let t=new URLSearchParams;if(e){var s,r;e.query&&t.append("query",e.query),(null===(s=e.type)||void 0===s?void 0:s.length)&&t.append("type",e.type.join(",")),(null===(r=e.status)||void 0===r?void 0:r.length)&&t.append("status",e.status.join(","))}let n=localStorage.getItem("auth_token"),i=await fetch("".concat(a,"/api/groups/export").concat(t.toString()?"?".concat(t.toString()):""),{headers:{...n&&{Authorization:"Bearer ".concat(n)}}});if(!i.ok)throw Error("Export failed: ".concat(i.statusText));return i.blob()}async bulkUpdateGroups(e,t){return this.fetchWithAuth("/api/groups/bulk",{method:"PUT",body:JSON.stringify({groupIds:e,updates:t})})}async bulkDeleteGroups(e){return this.fetchWithAuth("/api/groups/bulk",{method:"DELETE",body:JSON.stringify({groupIds:e})})}async getGroupTypes(){return[{value:"small_group",label:"Small Group",description:"Intimate fellowship and Bible study groups"},{value:"ministry",label:"Ministry Team",description:"Service-focused ministry groups"},{value:"youth",label:"Youth Group",description:"Teen and young adult groups"},{value:"seniors",label:"Seniors Group",description:"Groups for older adults"},{value:"womens",label:"Women's Group",description:"Women's fellowship and study groups"},{value:"mens",label:"Men's Group",description:"Men's fellowship and study groups"},{value:"children",label:"Children's Group",description:"Groups for children and families"},{value:"worship",label:"Worship Team",description:"Music and worship ministry teams"},{value:"service",label:"Service Team",description:"Community service and outreach teams"},{value:"bible_study",label:"Bible Study",description:"Scripture study and discussion groups"},{value:"prayer",label:"Prayer Group",description:"Prayer and intercession groups"},{value:"outreach",label:"Outreach Team",description:"Evangelism and community outreach"},{value:"other",label:"Other",description:"Custom group types"}]}constructor(){this.requestCache=new Map,this.pendingRequests=new Map,this.CACHE_DURATION=3e4,this.MAX_RETRIES=2}}let n=new r},2850:function(e,t,s){"use strict";s.d(t,{H:function(){return n}});let a="https://faithlink360-api.onrender.com";class r{async fetchWithAuth(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=localStorage.getItem("auth_token"),a=e.startsWith("http")?e:"http://localhost:8000".concat(e),r=0;for(;r<=this.MAX_RETRIES;)try{let e=await fetch(a,{...t,headers:{"Content-Type":"application/json",...s&&{Authorization:"Bearer ".concat(s)},...t.headers}});if(!e.ok){if(401===e.status){localStorage.removeItem("auth_token"),window.location.href="/login";return}let t=await e.json().catch(()=>({message:e.statusText}));throw Error(t.message||"HTTP ".concat(e.status,": ").concat(e.statusText))}return e.json()}catch(e){if(r<this.MAX_RETRIES&&e.message.includes("fetch")){r++,await new Promise(e=>setTimeout(e,1e3*r));continue}throw e}}getCacheKey(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(e,"-").concat(JSON.stringify(t.body||{}))}isValidCache(e){let t=this.requestCache.get(e);return!!t&&Date.now()-t.timestamp<this.CACHE_DURATION}async getMembers(e){let t=new URLSearchParams;if(e){var s,a,r;e.query&&t.append("query",e.query),(null===(s=e.tags)||void 0===s?void 0:s.length)&&t.append("tags",e.tags.join(",")),(null===(a=e.membershipStatus)||void 0===a?void 0:a.length)&&t.append("status",e.membershipStatus.join(",")),e.sortBy&&t.append("sortBy",e.sortBy),e.sortOrder&&t.append("sortOrder",e.sortOrder),e.limit&&t.append("limit",e.limit.toString()),e.offset&&t.append("offset",e.offset.toString()),e.ageRange&&(e.ageRange.min&&t.append("ageMin",e.ageRange.min.toString()),e.ageRange.max&&t.append("ageMax",e.ageRange.max.toString())),e.joinDateRange&&(e.joinDateRange.start&&t.append("joinStart",e.joinDateRange.start.toISOString()),e.joinDateRange.end&&t.append("joinEnd",e.joinDateRange.end.toISOString())),(null===(r=e.groups)||void 0===r?void 0:r.length)&&t.append("groups",e.groups.join(","))}let n="/api/members".concat(t.toString()?"?".concat(t.toString()):""),i=this.getCacheKey(n);if(this.isValidCache(i))return this.requestCache.get(i).data;if(this.pendingRequests.has(i))return this.pendingRequests.get(i);let l=this.fetchWithAuth(n).then(e=>(this.requestCache.set(i,{data:e,timestamp:Date.now()}),this.pendingRequests.delete(i),e)).catch(e=>{throw this.pendingRequests.delete(i),e});return this.pendingRequests.set(i,l),l}async getMember(e){return this.fetchWithAuth("/api/members/".concat(e))}async createMember(e){return this.fetchWithAuth("/api/members",{method:"POST",body:JSON.stringify(e)})}async updateMember(e){return this.fetchWithAuth("/api/members/".concat(e.id),{method:"PUT",body:JSON.stringify(e)})}async deleteMember(e){await this.fetchWithAuth("/api/members/".concat(e),{method:"DELETE"})}async getMemberStats(){return this.fetchWithAuth("/api/members/stats")}async getTags(){return this.fetchWithAuth("/api/members/tags")}async createTag(e){return this.fetchWithAuth("/api/members/tags",{method:"POST",body:JSON.stringify(e)})}async updateTag(e,t){return this.fetchWithAuth("/api/members/tags/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async deleteTag(e){await this.fetchWithAuth("/api/members/tags/".concat(e),{method:"DELETE"})}async uploadProfilePhoto(e,t){let s=localStorage.getItem("auth_token"),r=new FormData;r.append("photo",t);let n=await fetch("".concat(a,"/api/members/").concat(e,"/photo"),{method:"POST",headers:{...s&&{Authorization:"Bearer ".concat(s)}},body:r});if(!n.ok)throw Error((await n.json().catch(()=>({message:n.statusText}))).message||"HTTP ".concat(n.status,": ").concat(n.statusText));return n.json()}async getSearchSuggestions(e){return this.fetchWithAuth("/api/members/search/suggestions?q=".concat(encodeURIComponent(e)))}async exportMembers(e){let t=new URLSearchParams;if(e){var s,r;e.query&&t.append("query",e.query),(null===(s=e.tags)||void 0===s?void 0:s.length)&&t.append("tags",e.tags.join(",")),(null===(r=e.membershipStatus)||void 0===r?void 0:r.length)&&t.append("status",e.membershipStatus.join(","))}let n=localStorage.getItem("auth_token"),i=await fetch("".concat(a,"/api/members/export").concat(t.toString()?"?".concat(t.toString()):""),{headers:{...n&&{Authorization:"Bearer ".concat(n)}}});if(!i.ok)throw Error("Export failed: ".concat(i.statusText));return i.blob()}async bulkUpdateMembers(e,t){return this.fetchWithAuth("/api/members/bulk",{method:"PUT",body:JSON.stringify({memberIds:e,updates:t})})}async bulkDeleteMembers(e){return this.fetchWithAuth("/api/members/bulk",{method:"DELETE",body:JSON.stringify({memberIds:e})})}constructor(){this.requestCache=new Map,this.pendingRequests=new Map,this.CACHE_DURATION=3e4,this.MAX_RETRIES=2}}let n=new r}},function(e){e.O(0,[7648,9246,4429,2971,2117,1744],function(){return e(e.s=8037)}),_N_E=e.O()}]);